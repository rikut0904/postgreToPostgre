# PostgreSQL to PostgreSQL ãƒ‡ãƒ¼ã‚¿ç§»è¡Œãƒ„ãƒ¼ãƒ« ä»•æ§˜æ›¸

## 1. æ¦‚è¦

ä»»æ„ã® PostgreSQL ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰åˆ¥ã® PostgreSQL ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã€Web UI ã‚’é€šã˜ã¦ãƒ‡ãƒ¼ã‚¿ã‚’ç§»è¡Œã™ã‚‹ãƒ„ãƒ¼ãƒ«ã€‚
ç‰¹å®šã®ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã«ä¾å­˜ã›ãšã€æ¥ç¶šæƒ…å ±ã‚’ UI ä¸Šã§æŒ‡å®šã™ã‚‹ã ã‘ã§æ±ç”¨çš„ã«åˆ©ç”¨ã§ãã‚‹ã€‚

### æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| ãƒ¬ã‚¤ãƒ¤ãƒ¼ | æŠ€è¡“ |
|---------|------|
| ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ | Go (net/http + gorilla/websocket) |
| ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ | HTML / CSS / JavaScript (ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãªã—ã€ã‚‚ã—ãã¯è»½é‡ãªã‚‚ã®) |
| DB ãƒ‰ãƒ©ã‚¤ãƒ | lib/pq ã¾ãŸã¯ pgx |
| ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡ | WebSocket (é€²æ—é€šçŸ¥) |

---

## 2. æ©Ÿèƒ½ä¸€è¦§

### 2.1 æ¥ç¶šç®¡ç†

| æ©Ÿèƒ½ | èª¬æ˜ |
|------|------|
| æ¥ç¶šæƒ…å ±å…¥åŠ› | ãƒ›ã‚¹ãƒˆã€ãƒãƒ¼ãƒˆã€DB åã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã€SSL ãƒ¢ãƒ¼ãƒ‰ã‚’ UI ä¸Šã§æŒ‡å®š |
| æ¥ç¶šãƒ†ã‚¹ãƒˆ | ã€Œãƒ†ã‚¹ãƒˆæ¥ç¶šã€ãƒœã‚¿ãƒ³ã§ç–é€šç¢ºèªã‚’å®Ÿæ–½ |
| æ¥ç¶šæƒ…å ±ä¿å­˜ | å…¥åŠ›ã—ãŸæ¥ç¶šæƒ…å ±ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã® LocalStorage ã«ä¿å­˜ãƒ»å‘¼ã³å‡ºã—å¯èƒ½ï¼ˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯ä»»æ„ï¼‰ |

- ç§»è¡Œå…ƒ (Source) ã¨ç§»è¡Œå…ˆ (Destination) ã® 2 ã¤ã®æ¥ç¶šã‚’ãã‚Œãã‚Œè¨­å®šã™ã‚‹

### 2.2 ã‚¹ã‚­ãƒ¼ãƒãƒ–ãƒ©ã‚¦ã‚¸ãƒ³ã‚°

æ¥ç¶šæˆåŠŸå¾Œã€ç§»è¡Œå…ƒ DB ã®æ§‹æˆã‚’ãƒ„ãƒªãƒ¼å½¢å¼ã§è¡¨ç¤ºã™ã‚‹ã€‚

```
ğŸ“ Schema: public
  ğŸ“„ Tables (12)
    â”” users
    â”” orders
    â”” ...
  ğŸ“„ Views (3)
  ğŸ“„ Functions (5)
  ğŸ“„ Sequences (8)
  ğŸ“„ Triggers (2)
ğŸ“ Schema: audit
  ğŸ“„ Tables (4)
  ...
```

### 2.3 ç§»è¡Œå¯¾è±¡ã®é¸æŠ

| ç²’åº¦ | èª¬æ˜ |
|------|------|
| ã‚¹ã‚­ãƒ¼ãƒå˜ä½ | ã‚¹ã‚­ãƒ¼ãƒã‚’é¸æŠã™ã‚‹ã¨é…ä¸‹ã®å…¨ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒç§»è¡Œå¯¾è±¡ã«ãªã‚‹ |
| ãƒ†ãƒ¼ãƒ–ãƒ«å˜ä½ | å€‹åˆ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’é¸æŠã—ã¦ç§»è¡Œå¯¾è±¡ã«ã™ã‚‹ |
| ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆç¨®åˆ¥ | ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ»ãƒ“ãƒ¥ãƒ¼ãƒ»é–¢æ•°ãƒ»ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ãƒ»ãƒˆãƒªã‚¬ãƒ¼ã‚’å€‹åˆ¥ã«é¸æŠå¯èƒ½ |

- ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã§é¸æŠã€ã€Œå…¨é¸æŠ / å…¨è§£é™¤ã€ãƒœã‚¿ãƒ³ã‚ã‚Š

### 2.4 ç§»è¡Œã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼ˆå®Ÿè¡Œå‰ã« UI ä¸Šã§é¸æŠï¼‰

| ã‚ªãƒ—ã‚·ãƒ§ãƒ³ | é¸æŠè‚¢ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ |
|-----------|--------|-----------|
| æ—¢å­˜ãƒ†ãƒ¼ãƒ–ãƒ«ã®æ‰±ã„ | `DROP ã—ã¦å†ä½œæˆ` / `æ—¢å­˜ã‚’ãã®ã¾ã¾ä½¿ã† (CREATE IF NOT EXISTS)` | æ—¢å­˜ã‚’ãã®ã¾ã¾ä½¿ã† |
| æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®æ‰±ã„ | `TRUNCATE å¾Œã« INSERT` / `æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã«è¿½è¨˜ (INSERT)` / `UPSERT (ON CONFLICT DO UPDATE)` | TRUNCATE å¾Œã« INSERT |
| ãƒãƒƒãƒã‚µã‚¤ã‚º | æ•°å€¤å…¥åŠ› (è¡Œæ•°) | 1000 |
| ä¸¦è¡Œãƒ¯ãƒ¼ã‚«ãƒ¼æ•° | æ•°å€¤å…¥åŠ› (0 = è‡ªå‹•: min(ãƒ†ãƒ¼ãƒ–ãƒ«æ•°, 8)) | 0 (è‡ªå‹•) |
| FK åˆ¶ç´„ | `ç§»è¡Œä¸­ã¯ç„¡åŠ¹åŒ–ã™ã‚‹` / `ãã®ã¾ã¾` | ç§»è¡Œä¸­ã¯ç„¡åŠ¹åŒ– |
| å®Ÿè¡Œãƒ¢ãƒ¼ãƒ‰ | `å®Ÿè¡Œ` / `ãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³ï¼ˆå®Ÿéš›ã«ã¯æ›¸ãè¾¼ã¾ãªã„ï¼‰` | å®Ÿè¡Œ |

### 2.5 ä¸¦è¡Œå‡¦ç†

goroutine ãƒ¯ãƒ¼ã‚«ãƒ¼ãƒ—ãƒ¼ãƒ«ã‚’ä½¿ã„ã€ä»¥ä¸‹ã®å‡¦ç†ã‚’ä¸¦è¡Œå®Ÿè¡Œã™ã‚‹ã€‚

| å‡¦ç† | ä¸¦è¡Œæ–¹å¼ | å‚™è€ƒ |
|------|---------|------|
| ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚³ãƒ”ãƒ¼ | ãƒ¯ãƒ¼ã‚«ãƒ¼ãƒ—ãƒ¼ãƒ« (æœ€å¤§ 8) | å„ãƒ¯ãƒ¼ã‚«ãƒ¼ãŒç‹¬è‡ª src/dst æ¥ç¶šã‚’ä¿æŒ |
| ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½œæˆ | ãƒ¯ãƒ¼ã‚«ãƒ¼ãƒ—ãƒ¼ãƒ« | DDL åé›†å¾Œã«ä¸¦è¡Œå®Ÿè¡Œ |
| åˆ¶ç´„ä½œæˆ | ãƒ¯ãƒ¼ã‚«ãƒ¼ãƒ—ãƒ¼ãƒ« | DDL åé›†å¾Œã«ä¸¦è¡Œå®Ÿè¡Œ |

- å„ãƒ¯ãƒ¼ã‚«ãƒ¼ã¯ç‹¬è‡ªã® `*pgx.Conn` ã‚’é–‹ãï¼ˆpgx ã¯ goroutine éå®‰å…¨ã®ãŸã‚å…±æœ‰ä¸å¯ï¼‰
- ãƒ†ãƒ¼ãƒ–ãƒ«å˜ä½ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã§å®Ÿè¡Œã—ã€å¤±æ•—ãƒ†ãƒ¼ãƒ–ãƒ«ã¯è¨˜éŒ²ã—ã¦ä»–ãƒ†ãƒ¼ãƒ–ãƒ«ã¯ç¶šè¡Œ
- å…¨ä½“é€²æ—ã¯ `sync/atomic` ã§ã‚¹ãƒ¬ãƒƒãƒ‰ã‚»ãƒ¼ãƒ•ã«ç®¡ç†
- context ã«ã‚ˆã‚‹ã‚­ãƒ£ãƒ³ã‚»ãƒ«ä¼æ’­ã«å¯¾å¿œ

### 2.6 ç§»è¡Œå¯¾è±¡ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆãƒ•ãƒ«ç§»è¡Œï¼‰

ä»¥ä¸‹ã®é †åºã§ç§»è¡Œã‚’å®Ÿè¡Œã™ã‚‹ã€‚ä¾å­˜é–¢ä¿‚ã‚’è€ƒæ…®ã—ãŸé †åºåˆ¶å¾¡ã‚’è¡Œã†ã€‚

```
1. ã‚¹ã‚­ãƒ¼ãƒ (CREATE SCHEMA)
2. ãƒ‡ãƒ¼ã‚¿å‹ (ENUM / Composite Type)
3. ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€  (CREATE TABLE) â€»FK åˆ¶ç´„ã‚’é™¤ã
4. ãƒ‡ãƒ¼ã‚¿ (COPY / INSERT / UPSERT) â† ä¸¦è¡Œå‡¦ç†
5. ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ (CREATE INDEX) â† ä¸¦è¡Œå‡¦ç†
6. åˆ¶ç´„ (ALTER TABLE ADD CONSTRAINT) â† ä¸¦è¡Œå‡¦ç†
7. ãƒ“ãƒ¥ãƒ¼ (CREATE VIEW)
8. é–¢æ•° / ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ (CREATE FUNCTION)
9. ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ (CREATE SEQUENCE)
10. ãƒˆãƒªã‚¬ãƒ¼ (CREATE TRIGGER)
```

### 2.7 å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿å¯¾å¿œ

| æ©Ÿèƒ½ | èª¬æ˜ |
|------|------|
| ãƒãƒƒãƒå‡¦ç† | æŒ‡å®šãƒãƒƒãƒã‚µã‚¤ã‚ºã§åˆ†å‰²ã—ã¦ INSERT/COPY |
| ä¸¦è¡Œå‡¦ç† | è¤‡æ•°ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ goroutine ãƒ¯ãƒ¼ã‚«ãƒ¼ãƒ—ãƒ¼ãƒ«ã§åŒæ™‚å‡¦ç† |
| é€²æ—è¡¨ç¤º | WebSocket ã§ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã«é€²æ—ç‡ãƒ»å‡¦ç†è¡Œæ•°ãƒ»çµŒéæ™‚é–“ã‚’è¡¨ç¤º |
| ãƒ†ãƒ¼ãƒ–ãƒ«åˆ¥é€²æ— | ãƒ†ãƒ¼ãƒ–ãƒ«ã”ã¨ã®é€²æ—ã‚’å€‹åˆ¥ã«è¡¨ç¤º |
| ä¸­æ–­ | UI ä¸Šã®ã€Œä¸­æ–­ã€ãƒœã‚¿ãƒ³ã§å®‰å…¨ã«åœæ­¢ï¼ˆcontext ã‚­ãƒ£ãƒ³ã‚»ãƒ«ï¼‰ |
| ãƒ­ã‚° | ç§»è¡Œãƒ­ã‚°ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ UI ã«è¡¨ç¤ºã—ã€ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚‚å‡ºåŠ› |

### 2.8 ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

| ã‚±ãƒ¼ã‚¹ | æŒ™å‹• |
|--------|------|
| æ¥ç¶šã‚¨ãƒ©ãƒ¼ | ç§»è¡Œã‚’åœæ­¢ã—ã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º |
| ãƒ†ãƒ¼ãƒ–ãƒ«å˜ä½ã‚¨ãƒ©ãƒ¼ | å¤±æ•—ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¨˜éŒ²ã—ã€ä»–ãƒ†ãƒ¼ãƒ–ãƒ«ã®ç§»è¡Œã¯ç¶šè¡Œã€‚UI ã«å¤±æ•—ä¸€è¦§ã‚’è¡¨ç¤º |
| INSERT ã‚¨ãƒ©ãƒ¼ï¼ˆé‡è¤‡ã‚­ãƒ¼ãªã©ï¼‰ | ã‚¨ãƒ©ãƒ¼ã‚’ãƒ­ã‚°ã«è¨˜éŒ² |
| ã‚¹ã‚­ãƒ¼ãƒä¸æ•´åˆ | ç§»è¡Œå‰ã®æ¤œè¨¼ãƒ•ã‚§ãƒ¼ã‚ºã§è­¦å‘Šã‚’è¡¨ç¤º |

---

## 3. ç”»é¢æ§‹æˆ

### 3.1 ãƒ¡ã‚¤ãƒ³ç”»é¢ï¼ˆ1 ãƒšãƒ¼ã‚¸æ§‹æˆã€ã‚¹ãƒ†ãƒƒãƒ—å½¢å¼ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PostgreSQL â†’ PostgreSQL Migration Tool              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚  Step 1: æ¥ç¶šè¨­å®š                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  ç§»è¡Œå…ƒ (Source)   â”‚  â”‚  ç§»è¡Œå…ˆ (Dest)   â”‚         â”‚
â”‚  â”‚  Host: _________  â”‚  â”‚  Host: _________  â”‚         â”‚
â”‚  â”‚  Port: _________  â”‚  â”‚  Port: _________  â”‚         â”‚
â”‚  â”‚  DB:   _________  â”‚  â”‚  DB:   _________  â”‚         â”‚
â”‚  â”‚  User: _________  â”‚  â”‚  User: _________  â”‚         â”‚
â”‚  â”‚  Pass: _________  â”‚  â”‚  Pass: _________  â”‚         â”‚
â”‚  â”‚  SSL:  [select]   â”‚  â”‚  SSL:  [select]   â”‚         â”‚
â”‚  â”‚  [ãƒ†ã‚¹ãƒˆæ¥ç¶š]      â”‚  â”‚  [ãƒ†ã‚¹ãƒˆæ¥ç¶š]      â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                    [æ¬¡ã¸ â†’]                           â”‚
â”‚                                                     â”‚
â”‚  Step 2: ç§»è¡Œå¯¾è±¡é¸æŠ                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  ğŸ“ public                               â”‚        â”‚
â”‚  â”‚    â˜‘ users        (1,234,567 rows)       â”‚        â”‚
â”‚  â”‚    â˜‘ orders       (5,678,901 rows)       â”‚        â”‚
â”‚  â”‚    â˜ logs         (12,345,678 rows)      â”‚        â”‚
â”‚  â”‚  ğŸ“ audit                                â”‚        â”‚
â”‚  â”‚    â˜‘ audit_logs   (890,123 rows)         â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                     â”‚
â”‚  Step 3: ç§»è¡Œã‚ªãƒ—ã‚·ãƒ§ãƒ³                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  æ—¢å­˜ãƒ†ãƒ¼ãƒ–ãƒ«: [æ—¢å­˜ã‚’ãã®ã¾ã¾ä½¿ã† â–¼]       â”‚        â”‚
â”‚  â”‚  æ—¢å­˜ãƒ‡ãƒ¼ã‚¿:   [TRUNCATE å¾Œã« INSERT â–¼]    â”‚        â”‚
â”‚  â”‚  ãƒãƒƒãƒã‚µã‚¤ã‚º: [1000]                     â”‚        â”‚
â”‚  â”‚  ä¸¦è¡Œãƒ¯ãƒ¼ã‚«ãƒ¼æ•°: [0 (è‡ªå‹•)]                â”‚        â”‚
â”‚  â”‚  FK åˆ¶ç´„:      [ç§»è¡Œä¸­ã¯ç„¡åŠ¹åŒ– â–¼]          â”‚        â”‚
â”‚  â”‚  å®Ÿè¡Œãƒ¢ãƒ¼ãƒ‰:   â—‰ å®Ÿè¡Œ  â—‹ ãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³        â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                     â”‚
â”‚  Step 4: å®Ÿè¡Œãƒ»é€²æ—                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  å…¨ä½“é€²æ—: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘ 56%           â”‚        â”‚
â”‚  â”‚  çµŒéæ™‚é–“: 00:03:24                       â”‚        â”‚
â”‚  â”‚                                          â”‚        â”‚
â”‚  â”‚  users:    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% (å®Œäº†)     â”‚        â”‚
â”‚  â”‚  orders:   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘  62% (å‡¦ç†ä¸­)    â”‚        â”‚
â”‚  â”‚  audit_logs: â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  0% (å¾…æ©Ÿä¸­)     â”‚        â”‚
â”‚  â”‚                                          â”‚        â”‚
â”‚  â”‚  [ãƒ­ã‚°è¡¨ç¤ºã‚¨ãƒªã‚¢]                          â”‚        â”‚
â”‚  â”‚  > users: 1,234,567 rows migrated         â”‚        â”‚
â”‚  â”‚  > orders: batch 3500/5679 processing...  â”‚        â”‚
â”‚  â”‚                                          â”‚        â”‚
â”‚  â”‚          [ä¸­æ–­]                            â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. API è¨­è¨ˆ

### REST API

| ãƒ¡ã‚½ãƒƒãƒ‰ | ãƒ‘ã‚¹ | èª¬æ˜ |
|---------|------|------|
| POST | `/api/test-connection` | æ¥ç¶šãƒ†ã‚¹ãƒˆ |
| POST | `/api/browse` | ç§»è¡Œå…ƒ DB ã®ã‚¹ã‚­ãƒ¼ãƒãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§ã‚’å–å¾— |
| POST | `/api/table-info` | ãƒ†ãƒ¼ãƒ–ãƒ«ã®è©³ç´°æƒ…å ±ï¼ˆè¡Œæ•°ã€ã‚«ãƒ©ãƒ å®šç¾©ï¼‰ã‚’å–å¾— |
| POST | `/api/migrate` | ç§»è¡Œã‚’é–‹å§‹ |
| POST | `/api/migrate/cancel` | ç§»è¡Œã‚’ä¸­æ–­ |
| GET  | `/api/migrate/status` | ç¾åœ¨ã®ç§»è¡ŒçŠ¶æ…‹ã‚’å–å¾— |

### WebSocket

| ãƒ‘ã‚¹ | èª¬æ˜ |
|------|------|
| `/ws/progress` | ç§»è¡Œé€²æ—ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šçŸ¥ |

#### WebSocket ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å½¢å¼

```json
{
  "type": "progress",
  "data": {
    "overall_percent": 56,
    "elapsed_seconds": 204,
    "tables": [
      {
        "schema": "public",
        "name": "users",
        "status": "completed",
        "total_rows": 1234567,
        "migrated_rows": 1234567,
        "percent": 100
      },
      {
        "schema": "public",
        "name": "orders",
        "status": "in_progress",
        "total_rows": 5678901,
        "migrated_rows": 3521000,
        "percent": 62
      }
    ],
    "current_phase": "data",
    "log_message": "orders: batch 3521/5679 processing...",
    "failedTables": [
      {
        "schema": "public",
        "name": "broken_table",
        "error": "column \"x\" does not exist"
      }
    ]
  }
}
```

---

## 5. ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
postgreToPostgre/
â”œâ”€â”€ main.go                        # ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ (port 8080)
â”œâ”€â”€ go.mod / go.sum
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ ABOUT.md                   # ãƒ„ãƒ¼ãƒ«æ¦‚è¦
â”‚   â””â”€â”€ SPEC.md                    # æœ¬ä»•æ§˜æ›¸
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ server/
â”‚   â”‚   â”œâ”€â”€ server.go              # HTTP ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
â”‚   â”‚   â””â”€â”€ handlers.go            # API ãƒãƒ³ãƒ‰ãƒ©ãƒ¼
â”‚   â”œâ”€â”€ migration/
â”‚   â”‚   â”œâ”€â”€ types.go               # ãƒ‡ãƒ¼ã‚¿å‹å®šç¾© (Request, Options, FailedTable ç­‰)
â”‚   â”‚   â”œâ”€â”€ manager.go             # ç§»è¡Œã‚¸ãƒ§ãƒ–ç®¡ç† (æ’ä»–åˆ¶å¾¡, 1ã‚¸ãƒ§ãƒ–ã®ã¿)
â”‚   â”‚   â”œâ”€â”€ migrator.go            # ç§»è¡Œãƒ­ã‚¸ãƒƒã‚¯ (goroutine ä¸¦è¡Œå‡¦ç†)
â”‚   â”‚   â””â”€â”€ progress.go            # é€²æ—ç®¡ç† (WebSocket é…ä¿¡, å¤±æ•—ãƒ†ãƒ¼ãƒ–ãƒ«è¨˜éŒ²)
â”‚   â”œâ”€â”€ database/
â”‚   â”‚   â”œâ”€â”€ connection.go          # DB æ¥ç¶š
â”‚   â”‚   â”œâ”€â”€ inspector.go           # ã‚¹ã‚­ãƒ¼ãƒæƒ…å ±å–å¾—
â”‚   â”‚   â””â”€â”€ query.go               # ã‚¯ã‚¨ãƒªãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â””â”€â”€ websocket/
â”‚       â”œâ”€â”€ hub.go                 # WebSocket ãƒãƒ–
â”‚       â””â”€â”€ client.go              # WebSocket ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â””â”€â”€ web/
    â”œâ”€â”€ index.html                 # ãƒ¡ã‚¤ãƒ³ç”»é¢
    â”œâ”€â”€ help.html                  # ãƒ˜ãƒ«ãƒ—ãƒšãƒ¼ã‚¸
    â”œâ”€â”€ css/style.css              # ã‚¹ã‚¿ã‚¤ãƒ«
    â””â”€â”€ js/app.js                  # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ­ã‚¸ãƒƒã‚¯
```

---

## 6. éæ©Ÿèƒ½è¦ä»¶

| é …ç›® | å†…å®¹ |
|------|------|
| åŒæ™‚ç§»è¡Œ | 1 ç§»è¡Œã‚¸ãƒ§ãƒ–ã®ã¿ï¼ˆåŒæ™‚å®Ÿè¡Œã¯ä¸å¯ï¼‰ |
| å¯¾å¿œ PostgreSQL ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | 12 ä»¥ä¸Š |
| ãƒ–ãƒ©ã‚¦ã‚¶ | Chrome / Firefox / Edge (æœ€æ–°ç‰ˆ) |
| èªè¨¼ | ãªã—ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ãƒ„ãƒ¼ãƒ«æƒ³å®šï¼‰ |
| ãƒãƒ¼ãƒˆ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ 8080ï¼ˆèµ·å‹•å¼•æ•°ã§å¤‰æ›´å¯èƒ½ï¼‰ |
| ãƒ­ã‚° | æ¨™æº–å‡ºåŠ› + `logs/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ› |

---

## 7. ä»Šå¾Œã®æ‹¡å¼µå€™è£œï¼ˆv1 ã‚¹ã‚³ãƒ¼ãƒ—å¤–ï¼‰

ä»¥ä¸‹ã¯åˆæœŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã¯å«ã‚ãªã„ãŒã€å°†æ¥çš„ã«æ¤œè¨ã™ã‚‹æ©Ÿèƒ½ã€‚

- ç§»è¡Œãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿å­˜ãƒ»å†åˆ©ç”¨
- ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å®Ÿè¡Œï¼ˆcron é€£æºï¼‰
- ç§»è¡Œå‰å¾Œã®ãƒ‡ãƒ¼ã‚¿ä»¶æ•°æ¯”è¼ƒãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
- ã‚«ãƒ©ãƒ ãƒãƒƒãƒ”ãƒ³ã‚°ï¼ˆç§»è¡Œå…ƒã¨ç§»è¡Œå…ˆã§ã‚«ãƒ©ãƒ åãŒç•°ãªã‚‹å ´åˆï¼‰
- WHERE æ¡ä»¶æŒ‡å®šã«ã‚ˆã‚‹éƒ¨åˆ†ç§»è¡Œ
- Docker ã‚¤ãƒ¡ãƒ¼ã‚¸æä¾›
